<app-header />

<main class="cart-page">
    <h1 class="cart-title">Shopping Cart</h1>

    <ng-container *ngIf="items.length > 0; else emptyCart">

        <div class="cart-items">
            <div class="cart-item" *ngFor="let item of items; let i = index">
                <span class="item-index">{{ i + 1 }}.</span>
                <img [src]="item.image" [alt]="item.name" class="item-img" />

                <div class="item-info">
                    <h3>{{ item.name }}</h3>
                    <p class="item-meta">{{ item.brand }} Â· {{ item.type }}</p>
                    <p class="item-price">RM {{ item.price.toFixed(2) }}</p>
                    <p class="item-stock" [class.stock-low]="item.stock <= 10 && item.stock > 0"
                        [class.stock-out]="item.stock === 0">
                        <ng-container *ngIf="item.stock === 0">âœ• Out of Stock</ng-container>
                        <ng-container *ngIf="item.stock > 0 && item.stock <= 10">âš  Only {{ item.stock }}
                            left</ng-container>
                        <ng-container *ngIf="item.stock > 10">âœ“ In Stock ({{ item.stock }} available)</ng-container>
                    </p>
                </div>

                <div class="item-controls">
                    <div class="quantity-selector">
                        <button (click)="decrement(item)" [disabled]="item.quantity <= 1">-</button>
                        <input type="number" [value]="item.quantity" (change)="updateQuantity(item.id, $event)"
                            [max]="item.stock" min="1" />
                        <button (click)="increment(item)" [disabled]="item.quantity >= item.stock">+</button>
                    </div>
                    <p class="item-total">RM {{ (item.price * item.quantity).toFixed(2) }}</p>
                </div>

                <button class="remove-btn" (click)="removeItem(item.id)" title="Remove">
                    ðŸ—‘
                </button>

            </div>
        </div>

        <div class="cart-divider"></div>

        <div class="subtotal-row">
            <span class="subtotal-label">Sub-Total :</span>
            <span class="subtotal-value">RM {{ subtotal.toFixed(2) }}</span>
        </div>

        <div class="cart-divider"></div>

        <div class="checkout-row">
            <button class="checkout-btn" routerLink="/checkout">Checkout</button>
        </div>

    </ng-container>

    <ng-template #emptyCart>
        <div class="empty-cart">
            <p>ðŸ›’ Your cart is empty.</p>
            <a routerLink="/products" class="continue-link">Browse Products</a>
        </div>
    </ng-template>
</main>

<app-footer />